/*! For license information please see taskpane.js.LICENSE.txt */
!function(){function e(){var n,o,r="function"==typeof Symbol?Symbol:{},c=r.iterator||"@@iterator",a=r.toStringTag||"@@toStringTag";function u(e,r,c,a){var u=r&&r.prototype instanceof d?r:d,l=Object.create(u.prototype);return t(l,"_invoke",function(e,t,r){var c,a,u,d=0,l=r||[],s=!1,f={p:0,n:0,v:n,a:m,f:m.bind(n,4),d:function(e,t){return c=e,a=0,u=n,f.n=t,i}};function m(e,t){for(a=e,u=t,o=0;!s&&d&&!r&&o<l.length;o++){var r,c=l[o],m=f.p,y=c[2];e>3?(r=y===t)&&(u=c[(a=c[4])?5:(a=3,3)],c[4]=c[5]=n):c[0]<=m&&((r=e<2&&m<c[1])?(a=0,f.v=t,f.n=c[1]):m<y&&(r=e<3||c[0]>t||t>y)&&(c[4]=e,c[5]=t,f.n=y,a=0))}if(r||e>1)return i;throw s=!0,t}return function(r,l,y){if(d>1)throw TypeError("Generator is already running");for(s&&1===l&&m(l,y),a=l,u=y;(o=a<2?n:u)||!s;){c||(a?a<3?(a>1&&(f.n=-1),m(a,u)):f.n=u:f.v=u);try{if(d=2,c){if(a||(r="next"),o=c[r]){if(!(o=o.call(c,u)))throw TypeError("iterator result is not an object");if(!o.done)return o;u=o.value,a<2&&(a=0)}else 1===a&&(o=c.return)&&o.call(c),a<2&&(u=TypeError("The iterator does not provide a '"+r+"' method"),a=1);c=n}else if((o=(s=f.n<0)?u:e.call(t,f))!==i)break}catch(e){c=n,a=1,u=e}finally{d=1}}return{value:o,done:s}}}(e,c,a),!0),l}var i={};function d(){}function l(){}function s(){}o=Object.getPrototypeOf;var f=[][c]?o(o([][c]())):(t(o={},c,(function(){return this})),o),m=s.prototype=d.prototype=Object.create(f);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,s):(e.__proto__=s,t(e,a,"GeneratorFunction")),e.prototype=Object.create(m),e}return l.prototype=s,t(m,"constructor",s),t(s,"constructor",l),l.displayName="GeneratorFunction",t(s,a,"GeneratorFunction"),t(m),t(m,a,"Generator"),t(m,c,(function(){return this})),t(m,"toString",(function(){return"[object Generator]"})),(e=function(){return{w:u,m:y}})()}function t(e,n,o,r){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}t=function(e,n,o,r){if(n)c?c(e,n,{value:o,enumerable:!r,configurable:!r,writable:!r}):e[n]=o;else{var a=function(n,o){t(e,n,(function(e){return this._invoke(n,o,e)}))};a("next",0),a("throw",1),a("return",2)}},t(e,n,o,r)}function n(e,t,n,o,r,c,a){try{var u=e[c](a),i=u.value}catch(e){return void n(e)}u.done?t(i):Promise.resolve(i).then(o,r)}function o(e){return function(){var t=this,o=arguments;return new Promise((function(r,c){var a=e.apply(t,o);function u(e){n(a,r,c,u,i,"next",e)}function i(e){n(a,r,c,u,i,"throw",e)}u(void 0)}))}}Office.onReady((function(){var t=document.querySelectorAll("input[name='duration']"),n=document.getElementById("half-day-section"),r=document.getElementById("date-section"),c=document.getElementById("end-date-section"),a=document.getElementById("type-section"),u=document.getElementById("submit-btn");t.forEach((function(e){e.addEventListener("change",(function(){n.classList.add("hidden"),c.classList.add("hidden"),r.classList.remove("hidden"),a.classList.remove("hidden"),"half"===e.value?n.classList.remove("hidden"):"multi"===e.value&&c.classList.remove("hidden")}))})),document.querySelectorAll("input, select").forEach((function(e){e.addEventListener("change",(function(){var e,t,n,o,r;u.classList.toggle("hidden",(e=document.querySelector("input[name='duration']:checked"),t=document.getElementById("start-date").value,n=document.getElementById("end-date").value,o=document.getElementById("leave-type").value,r=document.querySelector("input[name='half-type']:checked"),!(e&&t&&o&&("multi"!==e.value||n)&&("half"!==e.value||r))))}))})),u.addEventListener("click",o(e().m((function t(){var n,o,r,c,a,u,i,d,l,s,f,m,y;return e().w((function(e){for(;;)switch(e.n){case 0:o=document.querySelector("input[name='duration']:checked").value,r=null===(n=document.querySelector("input[name='half-type']:checked"))||void 0===n?void 0:n.value,c=document.getElementById("leave-type").value,a=document.getElementById("start-date").value,u=document.getElementById("end-date").value||a,i=new Date(a),d=new Date(u),l=Office.context.mailbox.userProfile.displayName,s="".concat(l," - ").concat(c),f=1,"multi"===o&&(m=Math.ceil((d-i)/864e5)+1,f=m),s+=" (".concat(f," jour").concat(f>1?"s":"",")"),y={subject:s,start:new Date(i),end:new Date(d),location:"",body:{contentType:"HTML",content:"".concat(l," est en cong√© (").concat(c,")")},requiredAttendees:[],optionalAttendees:[],reminder:{minutesBeforeStart:15}},"half"===o?"AM"===r?(y.start.setHours(0,0),y.end.setHours(14,0)):(y.start.setHours(14,0),y.end.setHours(23,59)):(y.start.setHours(0,0),y.end.setHours(23,59)),Office.context.mailbox.displayAppointmentForm(y);case 1:return e.a(2)}}),t)}))))}))}();
//# sourceMappingURL=taskpane.js.map